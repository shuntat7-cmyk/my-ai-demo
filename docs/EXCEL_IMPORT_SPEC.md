# Excel インポート仕様

## 必要なもの一覧

| 項目 | 内容 |
|------|------|
| **パッケージ** | `xlsx`（SheetJS）— ブラウザで Excel を読み取り |
| **フォーマット** | 1シート「アクティビティ」。列: 日付・クライアント・アクティビティ・ステータス |
| **進捗数値** | インポートした行から自動集計（商談中／提案済み／完了の件数） |
| **UI** | トップページに「Excelをインポート」ボタン＋ファイル選択。取り込み後にダッシュボードを更新 |
| **テンプレート** | 任意。同じフォーマットの空 Excel をダウンロードできると親切 |

---

## Excel フォーマット（固定）

- **シート名**: 任意（先頭シートを読む）
- **1行目**: ヘッダー（必須）
- **2行目以降**: データ行

| 列（A） | 列（B） | 列（C） | 列（D） |
|--------|--------|--------|--------|
| 日付 | クライアント | アクティビティ | ステータス |
| 2025-03-01 | 株式会社サンプル | 提案書送付 | 提案済み |
| ... | ... | ... | ... |

- **日付**: `YYYY-MM-DD` または Excel の日付（数値なら変換可）
- **ステータス**: `商談中` / `提案済み` / `完了` のいずれか（進捗集計に使用）
- 空行はスキップ

---

## データの流れ

1. ユーザーが .xlsx を選択
2. ブラウザで `xlsx` がファイルを解析
3. 上記フォーマットに合わせて行を配列に変換
4. ステータスごとに件数を集計 → カードの数値に反映
5. 行データ → 「最新のアクティビティ」テーブルに表示

※ サーバー・DB は不要。状態は React state のみ（リロードで初期データに戻る）。

---

## 実装済み

- パッケージ: `xlsx`
- `lib/parseExcel.ts`: バッファをパースし `{ activities, summary }` を返す
- トップページ: 「Excelをインポート」ボタン、ファイル選択で取り込み → 進捗カード・アクティビティテーブルを更新
- テンプレートダウンロード: 未実装（必要なら `xlsx.utils.book_new` 等で空のテンプレートを生成可能）
